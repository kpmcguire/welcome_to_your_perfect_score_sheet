let fence_selector="fence-active",house_selector="house:not(.empty)",development_selector="development",amount_selector="amount",ok_to_save=!1;function update_developments(e,t,n,o){let l=document.querySelectorAll(`.${e} + .${t}`),c={1:0,2:0,3:0,4:0,5:0,6:0};l.forEach((function(t){var n=[];for(n.push(t);t.nextElementSibling&&!t.nextElementSibling.matches(`.${e}`);)n.push(t=t.nextElementSibling);n.forEach((function(e){e.classList.add("gloop")}))})),document.querySelectorAll(`.${e} + .${t}`).forEach((function(n){let o,l=[];for(l.push(n);n.nextElementSibling&&!n.nextElementSibling.matches(`.${e}`);)l.push(n=n.nextElementSibling);let a=0,r=0;for(var u in l.forEach((function(e){e.matches(`.${t}`)&&a++,e.classList.contains("empty")&&r++,(a>6||r>0)&&(o=!0)})),1==o&&l.forEach((function(e){e.classList.remove("gloop")})),c)c.hasOwnProperty(u)&&(a!=u||o||c[u]++)}));let a="";for(var r in c)c.hasOwnProperty(r)&&(a+=`<div id='houses-${r}-developments'>${c[r]}</div>`),document.getElementById("developments").innerHTML=a;update_investments()}function update_pools(){document.querySelectorAll("#pools-container").forEach((function(e){let t=e.id,n=[];e.querySelectorAll(".pool-input").forEach((function(e){e.checked&&n.push(Number(e.value))}));let o=Math.max.apply(Math,n);document.getElementById(`score-${t}`).innerHTML=o}))}function update_parks(){document.querySelectorAll(".park-row").forEach((function(e){let t=e.id,n=[];e.querySelectorAll(".park").forEach((function(e){e.checked&&n.push(Number(e.value))}));let o=Math.max.apply(Math,n);document.getElementById(`score-${t}`).innerHTML=o}));let e=document.querySelectorAll(".park-score"),t=0;e.forEach((function(e){t+=Number(e.innerHTML)})),document.getElementById("park-total").innerHTML=t}function update_temps(){document.querySelectorAll(".temp-row").forEach((function(e){let t=e.id,n=0;e.querySelectorAll(".temp").forEach((function(e){e.checked&&n++})),document.getElementById(`score-${t}`).innerHTML=n}))}function update_investments(){document.querySelectorAll(".development-row").forEach((function(e){let t=e.id,n=[];e.querySelectorAll(".development-input").forEach((function(e){e.checked&&n.push(Number(e.value))}));let o=Math.max.apply(Math,n),l=t.slice(-1),c=document.getElementById(`houses-${l}-developments`).innerHTML;c=null===c?1:Number(c),document.getElementById(`score-${t}`).innerHTML=o*c}))}function update_bis(){document.querySelectorAll("#bis-container").forEach((function(e){let t=e.id,n=[];e.querySelectorAll(".bis-input").forEach((function(e){e.checked&&n.push(Number(e.value))}));let o=Math.max.apply(Math,n);document.getElementById(`score-${t}`).innerHTML=-1*o}))}function update_permit_refusals(){document.querySelectorAll("#permit-refusal-container").forEach((function(e){let t=e.id,n=[];e.querySelectorAll(".permit-refusal-input").forEach((function(e){e.checked&&n.push(Number(e.value))}));let o=Math.max.apply(Math,n);document.getElementById(`score-${t}`).innerHTML=-1*o}))}function update_city_plans(){let e=document.querySelectorAll(".city-plan-score-input"),t=0;e.forEach((function(e){t+=Number(e.value)})),document.getElementById("city-plans-total").innerHTML=t}function update_total(){let e=document.querySelectorAll(".total-sub");total_score=0,e.forEach((function(e){"INPUT"==e.tagName?total_score+=Number(e.value):total_score+=Number(e.innerHTML)})),document.getElementById("total-score").innerHTML=total_score}function save_all(){if(ok_to_save){localStorage.clear();let e={},t={};document.querySelectorAll('input[type="text"]').forEach((function(t){e[t.id]=t.value})),document.querySelectorAll('input[type="checkbox"]').forEach((function(e){t[e.id]=e.checked}));let n=JSON.stringify(e),o=JSON.stringify(t);localStorage.setItem("all_checkboxes",o),localStorage.setItem("all_texts",n)}}function restore_all(){let e=JSON.parse(localStorage.getItem("all_checkboxes"));for(let[t,n]of Object.entries(e)){let e=document.getElementById(`${t}`);0==e.checked&&1==n?(e.checked=n,e.dispatchEvent(new Event("change",{bubbles:!0}))):e.checked=n}let t=JSON.parse(localStorage.getItem("all_texts"));for(let[e,n]of Object.entries(t)){let t=document.getElementById(`${e}`);t.value=n,t.dispatchEvent(new Event("change",{bubbles:!0}))}ok_to_save=!0}function reset_all(){document.querySelectorAll('input[type="text"]').forEach((function(e){e.value="",e.dispatchEvent(new Event("change",{bubbles:!0}))})),document.querySelectorAll('input[type="checkbox"]').forEach((function(e){e.checked&&0==e.disabled&&(e.checked=!1,e.dispatchEvent(new Event("change",{bubbles:!0})))})),update_developments(fence_selector,house_selector,development_selector,amount_selector),update_parks(),update_temps(),update_investments()}document.querySelectorAll(".park-row").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".park")&&(update_parks(),update_total(),save_all())}))})),document.querySelectorAll("#pools-container").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".pool-input")&&(update_pools(),update_total(),save_all())}))})),document.querySelectorAll(".temp-row").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".temp")&&(update_temps(),update_total(),save_all())}))})),document.querySelectorAll(".development-row").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".development-input")&&(update_investments(),update_total(),save_all())}))})),document.querySelectorAll(".row").forEach((function(e){e.addEventListener("change",(function(e){if(e.target.matches(".fence-input")){let t=e.target;t.parentNode.parentNode.classList.contains("fence-active")?t.parentNode.parentNode.classList.remove("fence-active"):t.parentNode.parentNode.classList.add("fence-active"),update_developments(fence_selector,house_selector,development_selector,amount_selector)}if(e.target.matches(".house input")){let t=e.target;t.value&&t.parentNode.classList.contains("empty")?t.parentNode.classList.remove("empty"):(t.parentNode.classList.add("empty"),t.parentNode.classList.remove("gloop")),update_developments(fence_selector,house_selector,development_selector,amount_selector)}update_total(),save_all()}))})),document.querySelectorAll("#city-plans-container").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".city-plan-score-input")&&(update_city_plans(),update_total(),save_all())}))})),document.getElementById("temp-score").addEventListener("change",(function(e){update_total(),save_all()})),document.querySelectorAll("#bis-container").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".bis-input")&&(update_bis(),update_total(),save_all())}))})),document.querySelectorAll("#permit-refusal-container").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".permit-refusal-input")&&(update_permit_refusals(),update_total(),save_all())}))})),document.querySelectorAll(".temp-winners").forEach((function(e){e.addEventListener("change",(function(e){e.target.matches(".temp-winner")&&save_all()}))})),document.getElementById("town-name").addEventListener("change",(function(e){save_all()})),window.addEventListener("DOMContentLoaded",e=>{restore_all()}),document.getElementById("reset").addEventListener("click",(function(e){e.preventDefault(),window.confirm("Do you really want to reset?")&&reset_all()}));